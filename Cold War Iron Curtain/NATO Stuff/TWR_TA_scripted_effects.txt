control_my_states = {
	every_owned_state = {
		PREV = {
			transfer_state = PREV
		}
	}
}

TA_intervention_ai_strategy = {
	every_country = {
		limit = {
			OR = {
				tag = USA
				tag = ENG
				tag = CAN
			}
		}
		every_country = {
			limit = {
				OR = {
					tag = GER
					tag = HSS
					tag = HGR
				}
			}
			PREV = {
				log = "[THIS.GetName] adding conquer/invade strategy to [PREV.GetName]"
				add_ai_strategy = {
					type = conquer
					id = PREV
					value = 100
				}
				add_ai_strategy = {
					type = invade
					id = PREV
					value = 100
				}
			}
		}
	}
}

TA_collapse_british_empire = {
	ENG = {
		#Gulf states
		release = BHR
		release = UAE
		release = QAT
		every_country = {
			limit = { OR = { tag = BHR tag = UAE tag = QAT } }
			control_my_states = yes
		}
		
		#Kuwait
		if = {
			limit = {
				owns_state = 656
				has_war_with = IRQ
			}
			IRQ = {
				transfer_state = 656
			}
		}
		else_if = {
			limit = {
				owns_state = 656
				has_war_with = SYR
				SYR = {
					owns_state = 291
					has_full_control_of_state = 291
				}
			}
			SYR = {
				transfer_state = 656
			}
		}
		else = {
			release = KUW
			KUW = { control_my_states = yes }
		}
		
		#Africa
		release = ARD
		release = DRF
		release = SUD
		release = TZN
		release = KEN
		release = ZAM
		release = ZIM
		release = BOT
		release = MLW
		release = MAD
		release = ZAN
		release = UGA
		release = BIA
		release = NGA
		release = SIE
		release = GAM
		release = GHA
		release = CMR
		every_country = {
			limit = { OR = { tag = ARD tag = DRF tag = SUD tag = TZN tag = KEN tag = ZAM tag = ZIM tag = BOT tag = MLW tag = MAD tag = ZAN tag = UGA tag = BIA tag = NGA tag = SIE tag = GAM tag = GHA tag = CMR } }
			control_my_states = yes
		}
		
		#Falklands
		every_owned_state = {
			limit = { OR = { state = 299 state = 720 } }
			ARG = {
				transfer_state = PREV
			}
		}
		
		#Belize - They don't have a leader or even a color so GUA will annex it
		if = {
			limit = {
				owns_state = 311
			}
			GUA = {
				transfer_state = 311
			}
		}
		
		#Atlantic Islands - Siezed by Portugal, will get annexed should Portugal be at war too
		every_owned_state = {
			limit = { OR = { state = 703 state = 704 } }
			POR = { transfer_state = PREV }
		}
		
		#Gibraltar
		if = {
			limit = {
				owns_state = 118
			}
			173 = {
				owner = {
					transfer_state = 118
				}
			}
		}
		
		#Second Free Officers Coup
		if = {
			limit = {
				EGY = {
					has_country_leader = {
						name = "Farouk I"
						ruling_only = yes
					}
				}
			}
			EGY = {
				set_cosmetic_tag = EGY_INDP
				create_country_leader = {
					name = "Mohamed Naguib"
					desc = "Mohamed_Naguib_DESC"
					picture = "Mohamed_Naguib.dds"
					expire = "1965.1.1"
					ideology = military_dictatorshipz
					traits = {

					}
				}
				set_party_name = { 
					ideology = paternal_autocrat 
					long_name = EGY_free_officers_long 
					name = EGY_free_officers 
				}
				remove_ideas = {
					EGY_western_influence
					EGY_discontented_population
				}
			}
		}
		
		#Suez Canal
		if = {
			limit = {
				owns_state = 773
			}
			446 = {
				owner = {
					transfer_state = 773
				}
			}
		}
	}
}
#Save either GER or SOV to the global event target ta_defeated_by
#This is so that collapsing to the soviets prioritizes having socialists pop up
#How to use this: Countries that should be peaced out must do so in a section, countries that should remain in the TA (pacific countries) should be added to the list, all other countries at war will be annexed by the victor
TA_collapse = {
	if = {
		limit = {
			event_target:ta_defeated_by = { tag = GER }
		}
		set_global_flag = TA_COLLAPSE_TO_GER
	}
	if = {
		limit = {
			event_target:ta_defeated_by = { tag = SOV }
		}
		set_global_flag = TA_COLLAPSE_TO_SOV
	}
	
	#Remove USA ties ideas from SA
	every_country = {
		limit = {
			has_idea = CENTRAL_american_ties
		}
		remove_ideas = CENTRAL_american_ties
		add_ideas = CENTRAL_drifting_apart
	}
	
	#Sakhailin/Kurils -> Owner of Vladivostok
	USA = {
		every_owned_state = {
			limit = {
				OR = {
					state = 655
					state = 537
					state = 555
				}
			}
			408 = {
				owner = {
					transfer_state = PREV.PREV
				}
			}
		}
	}
	
	#Soviets take down a russia that has fled to Sakhalin
	if = {
		limit = {
			has_global_flag = TA_COLLAPSE_TO_SOV
			country_exists = RUS
			RUS = {
				NOT = {
					owns_state = 408
				}
				owns_state = 655
			}
		}
		SOV = {
			annex_country = {
				target = RUS
				transfer_troops = no
			}
		}
	}
	
	#Korea
	USA = {
		diplomatic_relation = {
			country = KOR
			relation = guarantee
			active = no
		}
	}
	KOR = {
		if = {
			limit = {
				USA = {
					owns_state = 905
				}
			}
			transfer_state = 905
		}
		if = {
			limit = {
				in_war_with_ta = yes
				408 = {
					owner = {
						OR = {
							tag = event_target:ta_defeated_by
							is_in_faction_with = event_target:ta_defeated_by
							is_subject_of = event_target:ta_defeated_by
						}
					}
				}
			}
			leave_faction = yes
			white_peace_with_all = yes
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_SOV
				}
				SOV = {
					annex_country = {
						target = KOR
						transfer_troops = no
					}
				}
			}
		}
	}
	
	#Mexico
	MEX = {
		remove_ideas = MEX_partner_of_the_accord
		if = {
			limit = {
				in_war_with_ta = yes
			}
			leave_faction = yes
			white_peace_with_all = yes
			if = {
				limit = {
					NOT = {
						country_exists = AIR
					}
				}
				release = AIR
				AIR = { control_my_states = yes }
			}
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_GER
				}
				set_politics = {
					ruling_party = fascist
					elections_allowed = no
				}
				add_popularity = {
					ideology = fascist
					popularity = 0.35
				}
				GER = {
					add_to_faction = MEX
				}
			}
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_SOV
				}
				set_politics = {
					ruling_party = marxist_leninist
					elections_allowed = no
				}
				add_popularity = {
					ideology = marxist_leninist
					popularity = 0.45
				}
				if = {
					limit = {
						SOV = {
							is_faction_leader = yes
						}
					}
					SOV = {
						add_to_faction = MEX
						add_to_faction = AIR
					}
				}
			}
		}
	}
	
	#Guatemala
	if = {
		limit = {
			has_global_flag = TA_COLLAPSE_TO_SOV
			GUA = {
				has_government = conservative
			}
		}
		GUA = {
			set_politics = { #Arbenz is back
				ruling_party = socialist
				elections_allowed = no
			}
		}
	}
	
	#Brazil
	if = {
		limit = {
			BRA = {
				in_war_with_ta = yes
			}
		}
		BRA = {
			leave_faction = yes
			white_peace_with_all = yes
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_GER
				}
				clr_country_flag = BRA_REPUBLIC
				set_politics = { ruling_party = paternal_autocrat }
				add_popularity = { ideology = social_democrat popularity = -0.2 }
				add_popularity = { ideology = paternal_autocrat popularity = 0.25 }
				add_popularity = { ideology = national_socialist popularity = 0.05 }
				add_ideas = { authoritarian_system }
				create_country_leader = {
					name = "Gois Monteiro"
					desc = "Eduardo_Gomes_desc"
					picture = "gfx/leaders/BRA/Gois_Monteiro.dds"
					expire = "2000.1.1"
					ideology = military_dictatorshipz 
					traits = {}
				}
				complete_national_focus = BRA_Monteiro_Junta
				set_country_flag = BRA_Pro_Germans
			}
		}
	}
	
	#BEL
	if = {
		limit = {
			BEL = {
				is_in_faction_with = USA
				any_owned_state = {
					OR = {
						is_core_of = ZAI
						is_core_of = KAT
						is_core_of = RWA
						is_core_of = BRD
					}
				}
			}
		}
		BEL = {
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_SOV
				}
				every_owned_state = {
					limit = {
						OR = {
							is_core_of = ZAI
							is_core_of = KAT
							is_core_of = RWA
							is_core_of = BRD
						}
					}
					add_core_of = COG
					COG = {
						transfer_state = PREV
					}
				}
			}
			else = {
				release = ZAI
				release = KAT
				release = RWA
				release = BRD
				every_country = {
					limit = { OR = { tag = ZAI tag = KAT tag = RWA tag = BRD } }
					control_my_states = yes
				}
			}
		}
	}
	
	#POR
	if = {
		limit = {
			POR = {
				in_war_with_ta = yes
			}
		}
		if = {
			limit = {
				POR = {
					owns_state = 721
				}
			}
			667 = {
				owner = {
					transfer_state = 721
				}
			}
		}
		if = {
			limit = {
				POR = {
					has_war_with = BAK
				}
			}
			BAK = {
				transfer_state = 948
				transfer_state = 947
				white_peace_with_all = yes
			}
		}
		else_if = {
			limit = {
				POR = {
					has_war_with = ANG
				}
			}
			ANG = {
				transfer_state = 540
				transfer_state = 947
				white_peace_with_all = yes
			}
		}
		POR = {
			release = BAK
			release = ANG
			release = MZB
			release = GNB
		}
		every_country = {
			limit = { OR = { tag = BAK tag = ANG tag = MZB tag = GNB } }
			control_my_states = yes
		}
	}
	
	#SPA
	if = {
		limit = {
			SPA = {
				in_war_with_ta = yes
			}
		}
		SPA = {
			release = EQG
			release = SAH
			release = MOR
		}
		every_country = {
			limit = { OR = { tag = EQG tag = SAH tag = MOR } }
			control_my_states = yes
		}
	}
	
	#FRA
	if = {
		limit = {
			FRA = {
				in_war_with_ta = yes
			}
		}
		FRA = {
			#Annex mainland
			every_owned_state = {
				limit = {
					OR = {
						region = 19
						region = 20
					}
				}
				if = {
					limit = {
						VIC = {
							exists = yes
							is_subject_of = event_target:ta_defeated_by
							controls_state = PREV
						}
					}
					VIC = {
						transfer_state = PREV
					}
					else = {
						event_target:ta_defeated_by = {
							transfer_state = PREV
						}
					}
				}
			}
			#Annex caribbean
			every_owned_state = {
				limit = {
					OR = {
						state = 694
						state = 310
					}
				}
				event_target:ta_defeated_by = {
					transfer_state = PREV
				}
			}
			#Return pacific islands to ENG
			every_owned_state = {
				limit = {
					OR = {
						state = 708
						state = 706
						state = 713
					}
				}
				ENG = {
					transfer_state = PREV
				}
			}
			#Release Africa
			release = ALG
			release = SEN
			release = MLI
			release = IVO
			release = CAR
			release = GAB
			release = RCG
			release = GNA
			release = VOL
			release = MRT
			release = CMR
			release = CHA
			release = NGR
			release = TOG
			release = DAH
			release = MAD
			every_country = {
				limit = { OR = { tag = ALG tag = SEN tag = MLI tag = IVO tag = CAR tag = GAB tag = RCG tag = GNA tag = VOL tag = MRT tag = CMR tag = CHA tag = NGR tag = TOG tag = DAH tag = MAD } }
				control_my_states = yes
			}
		}
	}
	
	#FFR
	if = {
		limit = {
			FFR = {
				exists = yes
				NOT = {
					has_government = socialist
				}
			}
		}
		FFR = {
			#Transfer the Algerian Desert to BAR if it exists
			if = {
				limit = {
					owns_state = 514
					BAR = {
						exists = yes
					}
				}
				BAR = {
					transfer_state = 514
				}
			}
			#Annex mainland
			every_owned_state = {
				limit = {
					OR = {
						region = 19
						region = 20
					}
				}
				if = {
					limit = {
						VIC = {
							exists = yes
							is_subject_of = event_target:ta_defeated_by
							controls_state = PREV
						}
					}
					VIC = {
						transfer_state = PREV
					}
					else = {
						event_target:ta_defeated_by = {
							transfer_state = PREV
						}
					}
				}
			}
			#Annex caribbean
			every_owned_state = {
				limit = {
					OR = {
						state = 694
						state = 310
					}
				}
				event_target:ta_defeated_by = {
					transfer_state = PREV
				}
			}
			#Release Algeria
			release = ALG
			ALG = { control_my_states = yes }
			#Return pacific islands to ENG
			every_owned_state = {
				limit = {
					OR = {
						state = 708
						state = 706
						state = 713
					}
				}
				ENG = {
					transfer_state = PREV
				}
			}
			#Socialist coup if the soviets win
			if = {
				limit = {
					has_global_flag = TA_COLLAPSE_TO_SOV
				}
				add_popularity = {
					ideology = socialist
					popularity = 0.40
				}
				set_politics = {
					ruling_party = socialist
					elections_allowed = no
				}
				remove_ideas = {
					FFR_minority_state
					FFR_french_limbo
				}
				load_focus_tree = generic
				set_cosmetic_tag = WAAF
				become_free = yes
				leave_faction = yes
				white_peace_with_all = yes
				release = MAD
				MAD = { control_my_states = yes }
			}
			#Total collapse otherwise
			else = {
				become_free = yes
				leave_faction = yes
				white_peace_with_all = yes
				release = SEN
				release = MLI
				release = IVO
				release = CAR
				release = GAB
				release = RCG
				release = GNA
				release = VOL
				release = MRT
				release = CMR
				release = CHA
				release = NGR
				release = TOG
				release = DAH
				release = MAD
				every_country = {
					limit = { OR = { tag = SEN tag = MLI tag = IVO tag = CAR tag = GAB tag = RCG tag = GNA tag = VOL tag = MRT tag = CMR tag = CHA tag = NGR tag = TOG tag = DAH tag = MAD } }
					control_my_states = yes
				}
			}
		}
	}
	
	#Tunisia
	if = {
		limit = {
			TUN = {
				in_war_with_ta = yes
			}
		}
		TUN = {
			become_free = yes
			leave_faction = yes
			white_peace_with_all = yes
			set_politics = {
				ruling_party = liberal
				elections_allowed = no
			}
		}
	}
	
	#Libya
	if = {
		limit = {
			LBA = {
				in_war_with_ta = yes
			}
		}
		LBA = {
			become_free = yes
			leave_faction = yes
			white_peace_with_all = yes
		}
	}
	
	#Alaska/PR/Greenland
	if = {
		limit = {
			USA = {
				owns_state = 463
			}
		}
		OCN = {
			transfer_state = 463
		}
	}
	USA = {
		every_owned_state = {
			limit = {
				OR = {
					state = 686
					state = 101
					state = 841
					AND = {
						state = 650
						has_global_flag = TA_COLLAPSE_TO_SOV
					}
				}
			}
			event_target:ta_defeated_by = {
				transfer_state = PREV
			}
		}
	}
	
	#Cyprus/Malta/Ulster
	ENG = {
		every_owned_state = {
			limit = {
				OR = {
					state = 116
					state = 183
					state = 119
				}
			}
			event_target:ta_defeated_by = {
				transfer_state = PREV
			}
		}
	}
	
	#Suriname
	if = {
		limit = {
			HOL = {
				owns_state = 695
				in_war_with_ta = yes
			}
		}
		VEN = {
			transfer_state = 695
		}
	}
	
	#English Caribbean
	if = {
		limit = {
			ENG = {
				in_war_with_ta = yes
			}
		}
		ENG = {
			every_owned_state = {
				limit = {
					OR = {
						region = 53 #caribbean sea
						state = 690 #northern bahamas
						state = 696 #bermuda
					}
				}
				event_target:ta_defeated_by = {
					transfer_state = PREV
				}
			}
		}
	}
	
	#Guyana
	every_state = {
		limit = {
			OR = {
				state = 687
				state = 309
				state = 310
			}
			owner = {
				in_war_with_ta = yes
			}
		}
		BRA = {
			transfer_state = PREV
		}
	}
	
	#Create Free France Pacific
	if = {
		limit = {
			ENG = {
				owns_state = 706
				owns_state = 708
				owns_state = 713
			}
		}
		FFP = {
			transfer_state = 708
			transfer_state = 706
			transfer_state = 713
			ENG = {
				puppet = PREV
			}
			add_popularity = {
				ideology = conservative
				popularity = 1
			}
			set_politics = {
				ruling_party = conservative
				elections_allowed = no
			}
			set_capital = { state = 706 }
		}
	}
	
	#Finally, annex/remove from faction all TA members who are not exiles
	every_country = {
		limit = {
			is_in_faction_with = USA
			NOT = {
				OR = { #Basically pacific countries/exile governments
					tag = USA
					tag = ENG
					tag = CAN
					tag = FFP
					tag = AST
					tag = NZL
					tag = HOL
					tag = MAL
					tag = SAR
					tag = JAP
				}
			}
		}
		if = {
			limit = {
				in_war_with_ta = yes
			}
			event_target:ta_defeated_by = {
				annex_country = {
					target = PREV
					transfer_troops = no
				}
			}
		}
		else = {
			leave_faction = yes
		}
	}
}

US_clamp_le_congrss = {
	clamp_variable = { var = congress_house_support min = 0 max = 100 }
	clamp_variable = { var = congress_senate_support min = 0 max = 100 }
}

TOR_initialize_voting = {
	for_each_scope_loop = {
		array = TOR.TOR_member_countries 

		activate_targeted_decision = { target = THIS decision = TOR_vote_yes }
		activate_targeted_decision = { target = THIS decision = TOR_vote_no }
		activate_targeted_decision = { target = THIS decision = TOR_vote_neutral }

		activate_mission = TOR_vote_mission

		country_event = {
			id = twrta.1014
			days = 0 
		}

		for_each_scope_loop = {
			array = TOR.TOR_member_countries

			activate_targeted_decision = { target = PREV decision = TOR_ai_whip_positive }
			#activate_targeted_decision = { target = PREV decision = TOR_ai_whip_negative } #deprecated
		}

		if = {
			limit = {
				NOT = { has_variable = TOR_vote_intention }
			}
			set_variable = { TOR_vote_intention = 0 }
		}

		if = {
			limit = {
				is_ai = no 
			}
			set_variable = { TOR_vote_intention = 0 }
		}

	}
	
	custom_effect_tooltip = TOR_begin_voting

	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_cleanup_voting = {
	for_each_scope_loop = {
		array = TOR.TOR_member_countries 

		clear_variable = TOR_vote_value
		clear_variable = TOR_vote_intention
		clr_country_flag = TOR_voted_on_issue

		remove_mission = TOR_vote_mission
		remove_targeted_decision = { target = THIS decision = TOR_vote_yes }
		remove_targeted_decision = { target = THIS decision = TOR_vote_no }
		remove_targeted_decision = { target = THIS decision = TOR_vote_neutral }
		for_each_scope_loop = {
			array = TOR.TOR_member_countries 

			remove_targeted_decision = { target = PREV decision = TOR_ai_whip_positive }
			#remove_targeted_decision = { target = PREV decision = TOR_ai_whip_negative } deprecated
		}

		TOR = { clear_variable = TOR_issue_id }
	}
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
	clear_global_event_target = TOR_toronto_accord_applicant
}

TOR_whip_positive = {
	hidden_effect = {
		if = { limit = { TOR_calculate_positive_whip_cost = yes } }
		var:TOR_whipper = { 
			var:TOR_whippee = {
				country_event = {
					id = twrta.1001
					days = 1 
				}
				set_country_flag = { flag = has_been_whipped_by_@PREV days = 30 value = 1 }
			}
			set_temp_variable = { TOR_pp_spent = TOR_whip_cost }
			multiply_temp_variable = { TOR_pp_spent = -1 }
			add_political_power = TOR_pp_spent
		}
	}
	set_country_flag = TOR_has_been_whipped_recently
	custom_effect_tooltip = TOR_whip_positive_click_tt
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_whip_negative = {
	hidden_effect = {
		if = { limit = { TOR_calculate_negative_whip_cost = yes } }
		var:TOR_whipper = { 
			var:TOR_whippee  = {
				country_event = {
					id = twrta.1004
					days = 1 
				}
				set_country_flag = { flag = has_been_whipped_by_@PREV days = 30 value = 1 }
			}
			set_temp_variable = { TOR_pp_spent = TOR_whip_cost }
			multiply_temp_variable = { TOR_pp_spent = -1 }
			add_political_power = TOR_pp_spent
		}
	}
	set_country_flag = TOR_has_been_whipped_recently
	custom_effect_tooltip = TOR_whip_negative_click_tt
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_sort_membership = {
	TOR = {
		get_sorted_scored_countries = {
			scorer = TOR_ranking_scorer
			array = TOR_member_countries 
		}
		add_to_variable = { TOR.TOR_gui_dirty = 0.1 }

		for_each_scope_loop = { #target trigger doesn't work lel
			array = TOR.faction_members 

			if = {
				limit = { is_subject = yes }
				remove_from_array = { array = TOR.TOR_member_countries value = THIS } 
			}
		}
	}
}

TOR_join = {
	add_to_array = { TOR.TOR_member_countries = THIS }

	custom_effect_tooltip = TOR_join_effect
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_leave = {
	remove_from_array = { TOR.TOR_member_countries = THIS }

	custom_effect_tooltip = TOR_leave_effect
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_become_major = {
	set_country_flag = TOR_major_member

	custom_effect_tooltip = TOR_become_major_effect
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_stop_major = {
	clr_country_flag = TOR_major_member

	custom_effect_tooltip = TOR_stop_major_effect
	add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
}

TOR_recalculate_member_effects = {
	set_variable = { TOR.TOR_GATT_bonus = global.TWR_UN_array^num }
	multiply_variable = { TOR.TOR_GATT_bonus = 0.002 }

	if = {
		limit = {
			NOT = { check_variable = { TOR.TOR_prev_military_cooperation = TOR.TOR_military_cooperation } }
		}
		for_each_scope_loop = {
			array = TOR.TOR_member_countries
			
			TOR_apply_military_effects = yes 
		}
		add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
	}
	if = {
		limit = {
			NOT = { check_variable = { TOR.TOR_prev_political_integration = TOR.TOR_political_integration } }
		}

		for_each_scope_loop = { 
			array = TOR.TOR_member_countries

			TOR_apply_political_effects = yes 
		}
		add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
	}
	set_variable = { TOR.TOR_prev_military_cooperation =  TOR.TOR_military_cooperation }
	set_variable = { TOR.TOR_prev_political_integration = TOR.TOR_political_integration } 
}

TOR_apply_military_effects = {

	if = {
		limit = { 
			check_variable = { TOR.TOR_military_cooperation < 20 } 
		}
		remove_ideas = TOR_military_1_idea 
	}
	else = {
		add_ideas = TOR_military_1_idea 
	}

	if = {
		limit = { 
			check_variable = { TOR.TOR_military_cooperation < 40 } 
		}
		remove_ideas = TOR_military_2_idea 
	}
	else = {
		add_ideas = TOR_military_2_idea 
	}

	#3 is controlled by a cycling event 

	if = {
		limit = { 
			check_variable = { TOR.TOR_military_cooperation < 75 } 
		}
		remove_ideas = TOR_military_4_idea 
	}
	else = {
		add_ideas = TOR_military_4_idea 
	}

	if = {
		limit = { 
			check_variable = { TOR.TOR_military_cooperation < 90 } 
		}
		remove_ideas = TOR_military_5_idea 
	}
	else = {
		add_ideas = TOR_military_5_idea 
	}
}

TOR_apply_political_effects = {
	#1 is handled in on_actions

	if = {
		limit = { 
			check_variable = { TOR.TOR_political_integration < 35 } 
		}
		remove_ideas = TOR_political_2_idea 
	}
	else = {
		add_ideas = TOR_political_2_idea 
	}

	if = {
		limit = { 
			check_variable = { TOR.TOR_political_integration < 50 } 
		}
		remove_ideas = TOR_political_3_idea 
	}
	else = {
		add_ideas = TOR_political_3_idea 
	}

	if = {
		limit = { 
			check_variable = { TOR.TOR_political_integration < 75 } 
		}
		remove_ideas = TOR_political_4_idea 
	}
	else = {
		add_ideas = TOR_political_4_idea 
	}

	if = {
		limit = { 
			check_variable = { TOR.TOR_political_integration < 90 } 
		}
		remove_ideas = TOR_political_5_idea 
	}
	else = {
		add_ideas = TOR_political_5_idea 
	}
}

TOR_remove_all_effects = {
	remove_ideas = {
		TOR_military_1_idea
		TOR_military_2_idea
		TOR_military_4_idea
		TOR_military_5_idea
		TOR_political_2_idea
		TOR_political_3_idea
		TOR_political_4_idea
		TOR_political_5_idea
	}
}

TOR_issue_1_effect = {
	#put the effects you want to do here!
	custom_effect_tooltip = "NOR_INTERVENTION_BILL"
	set_global_flag = TA_INTERVENING_IN_NOR
	NOR = {
	country_event = twrTAnew.1
	}
	every_country = {
	limit = { is_ally_with = TOR }
	reverse_add_opinion_modifier = {
    target = NOR
    modifier = medium_increase
		}
	add_opinion_modifier = {
    target = NOR
    modifier = medium_increase
		}
	}
	ENG = {
	add_equipment_to_stockpile = {
	    type = anti_tank_equipment
	    amount = -100
		}
	}
	TOR = {
	add_equipment_to_stockpile = {
	    type = infantry_equipment
	    amount = -500
		}
	}
}

TOR_issue_2_effect = {

	hidden_effect = {
		HSS = {
			country_event = { 
				id = twrta.2000
			}
		}
		GER = {
			country_event = { 
				id = twrta.2000
			}
		}
		HGR = {
			country_event = { 
				id = twrta.2000
			}
		}
	}

	custom_effect_tooltip = TOR_foretop_effect_tt

	effect_tooltip = {
		ROOT = {
			add_timed_idea = {
				idea = TOR_exercise_foretop
				days = 180
			}
	
	
			navy_experience = 10
			air_experience = 10 
			army_experience = 2.5 
		}
	}

	

	add_to_variable = {
		TOR_military_cooperation = 4
		tooltip = TOR_military_cooperation_change_tt
	}

	for_each_scope_loop = {
		array = TOR.TOR_member_countries 

		add_timed_idea = {
			idea = TOR_exercise_foretop
			days = 180
		}


		navy_experience = 10
		air_experience = 10 
		army_experience = 2.5 

		country_event = {
			id = twrta.2001 
			days = 5 
		}

	}
}

TOR_issue_3_effect = {
	#put the effects you want to do here!
	custom_effect_tooltip = "TOR_APPLICATION_BILL"
	TOR = {
	add_to_faction = event_target:TOR_toronto_accord_applicant
	}
	event_target:TOR_toronto_accord_applicant = {
	country_event = twrta.3001
	}
	clear_global_event_target = TOR_toronto_accord_applicant
	add_to_variable = {
		TOR_military_cooperation = -1
		tooltip = TOR_military_cooperation_change_tt
	}
	add_to_variable = {
		TOR_political_integration = -1
		tooltip = TOR_civil_integration_change_tt
	}
}

TOR_motion_to_join = {
	set_variable = { TOR.TOR_issue_id = 3 }
	custom_effect_tooltip = "TA_FORMAL_JOIN_MOTION_START"
	ROOT = {
	save_global_event_target_as = TOR_toronto_accord_applicant
	}
	if = {
	limit = { event_target:TOR_toronto_accord_applicant = { tag = FRA } }
		AST = { 
			set_variable = { TOR_vote_intention = 5 }
		}
		ENG = { 
			set_variable = { TOR_vote_intention = 5 } #countries with voting intentions 10 < or -10> will automatically whip
		}
		CAN = { 
			set_variable = { TOR_vote_intention = 5 } 
		}
		USA = { 
			set_variable = { TOR_vote_intention = 10 }
		}
	}
	if = {
	limit = { event_target:TOR_toronto_accord_applicant = { tag = NOR } }
		AST = { 
			set_variable = { TOR_vote_intention = 5 }
		}
		ENG = { 
			set_variable = { TOR_vote_intention = 10 } #countries with voting intentions 10 < or -10> will automatically whip
		}
		CAN = { 
			set_variable = { TOR_vote_intention = 5 } 
		}
		USA = { 
			set_variable = { TOR_vote_intention = 5 }
		}
	}
	if = {
	limit = { event_target:TOR_toronto_accord_applicant = { tag = RUS } }
		ENG = { 
			set_variable = { TOR_vote_intention = 5 } #countries with voting intentions 10 < or -10> will automatically whip
		}
		USA = { 
			set_variable = { TOR_vote_intention = 10 }
		}
		if = {
		limit = { FRA = { is_in_faction_with = TOR } }
		FRA = { 
			set_variable = { TOR_vote_intention = -5 }
			}
		}
	}
	if = {
	limit = { event_target:TOR_toronto_accord_applicant = { tag = SOV } }
		AST = { 
			set_variable = { TOR_vote_intention = -5 }
		}
		ENG = { 
			set_variable = { TOR_vote_intention = -5 } #countries with voting intentions 10 < or -10> will automatically whip
		}
		CAN = { 
			set_variable = { TOR_vote_intention = -5 } 
		}
		USA = { 
			set_variable = { TOR_vote_intention = 10 }
		}
		if = {
		limit = { FRA = { is_in_faction_with = TOR } }
		FRA = { 
			set_variable = { TOR_vote_intention = -5 }
			}
		}
	}
	TOR_initialize_voting = yes 
}