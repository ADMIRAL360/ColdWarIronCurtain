TOR_decisions_category = {

	TOR_vote_yes = {
		allowed = {
			always = no 
		}

		visible = { 
			NOT = {
				has_country_flag = TOR_voted_on_issue 
			}
		}

		complete_effect = {
			set_country_flag = TOR_voted_on_issue
			set_variable = { TOR_vote_value = 1 }

			if = {
				limit = {
					is_ai = no
				}

				set_variable = { TOR_vote_intention = 5  }
			}
			add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
			
		}

		ai_will_do = {
			modifier = {
				add = 10 
				check_variable = { TOR_vote_intention > 0 }
			}
		}
	}

	TOR_vote_no = {
		allowed = { always = no }

		visible = {
			NOT = {
				has_country_flag = TOR_voted_on_issue 
			}
		}

		complete_effect = {
			set_country_flag = TOR_voted_on_issue
			set_variable = { TOR_vote_value = -1 }
			if = {
				limit = {
					is_ai = no
				}

				set_variable = { TOR_vote_intention = -5  }
			}
			add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
		}

		ai_will_do = {
			modifier = {
				add = 10 

				check_variable = { TOR_vote_intention < 0 }
			}
		}
	}

	TOR_vote_neutral = {
		allowed = { always = no }

		visible = {
			NOT = {
				has_country_flag = TOR_voted_on_issue 
			}
		}

		complete_effect = {
			set_country_flag = TOR_voted_on_issue
			set_variable = { TOR_vote_value = 0 }
			add_to_variable = { TOR.TOR_gui_dirty = 0.1 }
		}

		ai_will_do = {
			modifier = {
				add = 10 

				check_variable = { TOR_vote_intention = 0 }
			}
		}
	}

	TOR_vote_mission = {

		allowed = { 
			always = no 
		}
		available = {

			TOR_total_votes = yes

			custom_trigger_tooltip = {

				set_temp_variable = { total_votes = TOR_votes_positive }
				add_to_temp_variable = { total_votes = TOR_votes_negative }
				add_to_temp_variable = { total_votes = TOR_votes_neutral }
				check_variable = { total_votes = TOR.TOR_member_countries^num }
				tooltip = TOR_countries_have_voted
			}
		
			custom_trigger_tooltip = {
				tooltip = TOR_voting_successful
				
				check_variable = { var = TOR_votes_positive value = TOR_votes_majority_needed compare = greater_than_or_equals }
			}

			custom_trigger_tooltip = {
				tooltip = TOR_voting_no_vetoes

				NOT = { check_variable = { TOR_votes_negative > 0 } }
			}

			hidden_trigger = { tag = TOR }
		}

		is_good = no
		days_mission_timeout = 30 

		complete_effect = {

			if = {
				limit = { 
					tag = TOR 
				}
				meta_effect = {
					text = {
						TOR_issue_[TOR_ACTIVE_ISSUE_TOKEN]_effect = yes 
					}
					TOR_ACTIVE_ISSUE_TOKEN = "[?TOR.TOR_issue_id]"
				}
				#custom_effect_tooltip = "show to TOR"
			}
			else = {
				effect_tooltip = {
					meta_effect = {
						text = {
							TOR_issue_[TOR_ACTIVE_ISSUE_TOKEN]_effect = yes 
						}
						TOR_ACTIVE_ISSUE_TOKEN = "[?TOR.TOR_issue_id]"
					}
				}
				#custom_effect_tooltip = "show to non TOR countries "
			}

			TOR_cleanup_voting = yes 	
		}

		timeout_effect = {
		if = {
		limit = { NOT = { TOR = { check_variable = { TOR_issue_id = 3 } } } }
			custom_effect_tooltip = TOR_vote_failure_tt
			hidden_effect = {
				if = {
					limit = { 
						TAG = TOR
					}

					add_to_variable = { TOR.TOR_political_cooperation = -5 }
				}
			}
		}
		else = {
			custom_effect_tooltip = TOR_vote_failure_none_tt
			event_target:TOR_toronto_accord_applicant = {
			country_event = twrta.3003
			}
		}
		TOR_cleanup_voting = yes 
		}
	}

	TOR_ai_whip_positive = {
		allowed = {
			always = no
		}

		fire_only_once = no

		#target_array = TOR.TOR_member_countries not needed really
		visible = { 
			is_ai = yes 
			check_variable = { TOR_vote_intention > 9.999 }
		}

		available = {
			set_temp_variable = { TOR_whipper = ROOT }
			set_temp_variable = { TOR_whippee = FROM }
			TOR_whip_positive_allowed = yes 
		}

		complete_effect = {
			set_temp_variable = { TOR_whipper = ROOT }
			set_temp_variable = { TOR_whippee = FROM }
			TOR_whip_positive = yes 
		}

		ai_will_do = {
			base = 0 #usually don't bother
			modifier = { #prioritize vetoers
				add = 200
				FROM = {
					check_variable = { TOR_vote_value < 0 }
				}
			}
			modifier = { #continue doing until a majority is secured, but don't do this if there is a vetoer still 
				add = 20
				TOR_total_votes = yes
				check_variable = { TOR_votes_positive < TOR_votes_majority_needed }
				NOT = { check_variable = { TOR_votes_negative > 0 } }
			}
			modifier = {
				add = -1000
				FROM = { #NEVER whip more than once
					has_country_flag = { flag = has_been_whipped_by_@PREV }
				}
			}
		}
	}

	# TOR_ai_whip_negative = { # THIS DECISION IS UNNECESSARY AS ALL TAGS HAVE A VETO POWER
	# 	allowed = {
	# 		always = no
	# 	}

	# 	fire_only_once = no

	# 	#target_array = TOR.TOR_member_countries not needed really
	# 	visible = { 
	# 		is_ai = yes 
	# 		check_variable = { TOR_vote_intention < -9.999 }
	# 	}

	# 	available = {
	# 		set_temp_variable = { TOR_whipper = ROOT }
	# 		set_temp_variable = { TOR_whippee = FROM }
	# 		TOR_whip_negative_allowed = yes 
	# 	}

	# 	complete_effect = {
	# 		set_temp_variable = { TOR_whipper = ROOT }
	# 		set_temp_variable = { TOR_whippee = FROM }
	# 		TOR_whip_negative = yes 
	# 	}

	# 	ai_will_do = { #AI will never 
	# 		base = 0 #usually don't bother 
	# 		modifier = { #prioritize voters for
	# 			add = 200
	# 			FROM = {
	# 				check_variable = { TOR_vote_value > 0 }
	# 			}
	# 		}
	# 	}
	#}

	TOR_mission_example_debug = {
		allowed = {
			always = yes
		}

		complete_effect = {
			set_variable = { TOR.TOR_issue_id = 1 }

			AST = { 
				set_variable = { TOR_vote_intention = 5 }
			}
			ENG = { 
				set_variable = { TOR_vote_intention = 10 } #countries with voting intentions 10 < or -10> will automatically whip
				add_political_power = 2000 #temporary to test AI prioritization
			}
			CAN = { 
				set_variable = { TOR_vote_intention = 5 } 
			}
			USA = { 
				set_variable = { TOR_vote_intention = 5 }
			}
			ICE = {
				set_variable = { TOR_vote_intention = 2 }
			}
			#custom_effect_tooltip = "tooltip here"
			TOR_initialize_voting = yes 
		}
	}
	TOR_norwegian_mission = {
		icon = generic_ignite_civil_war
		allowed = {
			tag = ENG
		}
		visible = {
		NOT = {
		TOR = {
		has_variable = TOR_issue_id
			}
		}
		NOR = {
		has_war_with = GER
		OR = {
		has_government = paternal_autocrat
		is_democratic = yes
				}
			}
		}
		cost = 10
		ai_will_do = {
			factor = 500
		}
		fire_only_once = yes
		complete_effect = {
			set_variable = { TOR.TOR_issue_id = 1 }

			AST = { 
				set_variable = { TOR_vote_intention = -5 }
			}
			ENG = { 
				set_variable = { TOR_vote_intention = 10 } #countries with voting intentions 10 < or -10> will automatically whip
			}
			CAN = { 
				set_variable = { TOR_vote_intention = 5 } 
			}
			USA = { 
				set_variable = { TOR_vote_intention = 5 }
			}
			custom_effect_tooltip = "TA_NORWAY_MOTION_START"
			TOR_initialize_voting = yes 
		}
	}
}