generate_global_state_array = {
	every_state = {
		add_to_array = { global.states = THIS.id }
	}
}

d_open_custom_mapmode = {
	clear_array = selected_filter_array
	add_to_array = { selected_filter_array = 1 }
	set_country_flag = custom_map_mode_visible
	#set_country_flag = custom_map_state_name_visible
}

my_custom_effect = {
	log = "EFFECT"
}

calculate_country_center_point_quick = {
	set_variable = {
		x_composite = 0
	}
	set_variable = {
		y_composite = 0
	}
	for_each_scope_loop = {
		array = controlled_states
		add_to_variable = { PREV.x_composite = THIS.map_x_position }
		add_to_variable = { PREV.y_composite = THIS.map_y_position }
	}
	divide_variable = { x_composite = controlled_states^num }
	divide_variable = { y_composite = controlled_states^num }
}
d_state_country_centers = {
	every_country = {
		calculate_country_center_point_quick = yes
	}
}